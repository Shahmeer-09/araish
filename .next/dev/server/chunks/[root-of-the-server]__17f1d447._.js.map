{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/downloads/project/jewelry-showcase/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined;\r\n};\r\n\r\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\r\n\r\nexport default prisma;\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,sMAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 68, "column": 0}, "map": {"version":3,"sources":["file:///E:/downloads/project/jewelry-showcase/lib/auth.ts"],"sourcesContent":["import { cookies } from 'next/headers';\r\nimport bcrypt from 'bcryptjs';\r\nimport prisma from './prisma';\r\n\r\nconst SESSION_COOKIE_NAME = 'admin_session';\r\nconst SESSION_SECRET = process.env.SESSION_SECRET || 'your-secret-key-change-in-production';\r\n\r\nexport async function hashPassword(password: string): Promise<string> {\r\n  return bcrypt.hash(password, 12);\r\n}\r\n\r\nexport async function verifyPassword(password: string, hashedPassword: string): Promise<boolean> {\r\n  return bcrypt.compare(password, hashedPassword);\r\n}\r\n\r\nexport async function createSession(username: string): Promise<string> {\r\n  const sessionToken = Buffer.from(`${username}:${Date.now()}:${SESSION_SECRET}`).toString('base64');\r\n  return sessionToken;\r\n}\r\n\r\nexport async function validateSession(): Promise<boolean> {\r\n  const cookieStore = await cookies();\r\n  const session = cookieStore.get(SESSION_COOKIE_NAME);\r\n  \r\n  if (!session?.value) {\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    const decoded = Buffer.from(session.value, 'base64').toString('utf-8');\r\n    const [username] = decoded.split(':');\r\n    \r\n    const admin = await prisma.admin.findUnique({\r\n      where: { username },\r\n    });\r\n\r\n    return !!admin;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function login(username: string, password: string): Promise<{ success: boolean; error?: string }> {\r\n  try {\r\n    const admin = await prisma.admin.findUnique({\r\n      where: { username },\r\n    });\r\n\r\n    if (!admin) {\r\n      return { success: false, error: 'Invalid credentials' };\r\n    }\r\n\r\n    const isValid = await verifyPassword(password, admin.password);\r\n\r\n    if (!isValid) {\r\n      return { success: false, error: 'Invalid credentials' };\r\n    }\r\n\r\n    const sessionToken = await createSession(username);\r\n    const cookieStore = await cookies();\r\n    \r\n    cookieStore.set(SESSION_COOKIE_NAME, sessionToken, {\r\n      httpOnly: true,\r\n      secure: process.env.NODE_ENV === 'production',\r\n      sameSite: 'lax',\r\n      maxAge: 60 * 60 * 24, // 24 hours\r\n      path: '/',\r\n    });\r\n\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Login error:', error);\r\n    return { success: false, error: 'An error occurred during login' };\r\n  }\r\n}\r\n\r\nexport async function logout(): Promise<void> {\r\n  const cookieStore = await cookies();\r\n  cookieStore.delete(SESSION_COOKIE_NAME);\r\n}\r\n\r\nexport async function createAdminIfNotExists(): Promise<void> {\r\n  const adminUsername = process.env.ADMIN_USERNAME || 'admin';\r\n  const adminPassword = process.env.ADMIN_PASSWORD || 'admin123';\r\n\r\n  const existingAdmin = await prisma.admin.findUnique({\r\n    where: { username: adminUsername },\r\n  });\r\n\r\n  if (!existingAdmin) {\r\n    const hashedPassword = await hashPassword(adminPassword);\r\n    await prisma.admin.create({\r\n      data: {\r\n        username: adminUsername,\r\n        password: hashedPassword,\r\n      },\r\n    });\r\n    console.log('Admin user created');\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AACA;AACA;;;;AAEA,MAAM,sBAAsB;AAC5B,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc,IAAI;AAE9C,eAAe,aAAa,QAAgB;IACjD,OAAO,8IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAgB,EAAE,cAAsB;IAC3E,OAAO,8IAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAEO,eAAe,cAAc,QAAgB;IAClD,MAAM,eAAe,OAAO,IAAI,CAAC,GAAG,SAAS,CAAC,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,gBAAgB,EAAE,QAAQ,CAAC;IACzF,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,UAAU,YAAY,GAAG,CAAC;IAEhC,IAAI,CAAC,SAAS,OAAO;QACnB,OAAO;IACT;IAEA,IAAI;QACF,MAAM,UAAU,OAAO,IAAI,CAAC,QAAQ,KAAK,EAAE,UAAU,QAAQ,CAAC;QAC9D,MAAM,CAAC,SAAS,GAAG,QAAQ,KAAK,CAAC;QAEjC,MAAM,QAAQ,MAAM,0HAAM,CAAC,KAAK,CAAC,UAAU,CAAC;YAC1C,OAAO;gBAAE;YAAS;QACpB;QAEA,OAAO,CAAC,CAAC;IACX,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,MAAM,QAAgB,EAAE,QAAgB;IAC5D,IAAI;QACF,MAAM,QAAQ,MAAM,0HAAM,CAAC,KAAK,CAAC,UAAU,CAAC;YAC1C,OAAO;gBAAE;YAAS;QACpB;QAEA,IAAI,CAAC,OAAO;YACV,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAsB;QACxD;QAEA,MAAM,UAAU,MAAM,eAAe,UAAU,MAAM,QAAQ;QAE7D,IAAI,CAAC,SAAS;YACZ,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAsB;QACxD;QAEA,MAAM,eAAe,MAAM,cAAc;QACzC,MAAM,cAAc,MAAM,IAAA,4IAAO;QAEjC,YAAY,GAAG,CAAC,qBAAqB,cAAc;YACjD,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK;YAClB,MAAM;QACR;QAEA,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO;YAAE,SAAS;YAAO,OAAO;QAAiC;IACnE;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;AACrB;AAEO,eAAe;IACpB,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc,IAAI;IACpD,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc,IAAI;IAEpD,MAAM,gBAAgB,MAAM,0HAAM,CAAC,KAAK,CAAC,UAAU,CAAC;QAClD,OAAO;YAAE,UAAU;QAAc;IACnC;IAEA,IAAI,CAAC,eAAe;QAClB,MAAM,iBAAiB,MAAM,aAAa;QAC1C,MAAM,0HAAM,CAAC,KAAK,CAAC,MAAM,CAAC;YACxB,MAAM;gBACJ,UAAU;gBACV,UAAU;YACZ;QACF;QACA,QAAQ,GAAG,CAAC;IACd;AACF"}},
    {"offset": {"line": 188, "column": 0}, "map": {"version":3,"sources":["file:///E:/downloads/project/jewelry-showcase/app/api/settings/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport prisma from '@/lib/prisma';\r\nimport { validateSession } from '@/lib/auth';\r\n\r\n// GET site settings\r\nexport async function GET() {\r\n  try {\r\n    const settings = await prisma.siteSettings.findUnique({\r\n      where: { key: 'main' },\r\n    });\r\n\r\n    if (!settings) {\r\n      return NextResponse.json({\r\n        bannerTitle: 'LUXE',\r\n        bannerSubtitle: 'Exquisite Handcrafted Jewelry',\r\n        shopNameUrdu: '',\r\n        hasBannerImage: false,\r\n      });\r\n    }\r\n\r\n    return NextResponse.json({\r\n      bannerTitle: settings.bannerTitle || 'LUXE',\r\n      bannerSubtitle: settings.bannerSubtitle || 'Exquisite Handcrafted Jewelry',\r\n      shopNameUrdu: settings.shopNameUrdu || '',\r\n      hasBannerImage: !!settings.bannerImage,\r\n    });\r\n  } catch (error) {\r\n    console.error('Error fetching settings:', error);\r\n    return NextResponse.json(\r\n      { error: 'Failed to fetch settings' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n// POST/PUT update settings\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const isAuthenticated = await validateSession();\r\n    if (!isAuthenticated) {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const formData = await request.formData();\r\n    const bannerTitle = formData.get('bannerTitle') as string;\r\n    const bannerSubtitle = formData.get('bannerSubtitle') as string;\r\n    const shopNameUrdu = formData.get('shopNameUrdu') as string;\r\n    const bannerImage = formData.get('bannerImage') as File | null;\r\n    const removeBanner = formData.get('removeBanner') === 'true';\r\n\r\n    const updateData: {\r\n      bannerTitle: string;\r\n      bannerSubtitle: string;\r\n      shopNameUrdu: string;\r\n      bannerImage?: Buffer | null;\r\n      bannerMimeType?: string | null;\r\n    } = {\r\n      bannerTitle: bannerTitle || 'LUXE',\r\n      bannerSubtitle: bannerSubtitle || 'Exquisite Handcrafted Jewelry',\r\n      shopNameUrdu: shopNameUrdu || '',\r\n    };\r\n\r\n    if (removeBanner) {\r\n      updateData.bannerImage = null;\r\n      updateData.bannerMimeType = null;\r\n    } else if (bannerImage && bannerImage.size > 0) {\r\n      const buffer = Buffer.from(await bannerImage.arrayBuffer());\r\n      updateData.bannerImage = buffer;\r\n      updateData.bannerMimeType = bannerImage.type;\r\n    }\r\n\r\n    const settings = await prisma.siteSettings.upsert({\r\n      where: { key: 'main' },\r\n      update: updateData,\r\n      create: {\r\n        key: 'main',\r\n        ...updateData,\r\n      },\r\n    });\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      bannerTitle: settings.bannerTitle,\r\n      bannerSubtitle: settings.bannerSubtitle,\r\n      shopNameUrdu: settings.shopNameUrdu,\r\n      hasBannerImage: !!settings.bannerImage,\r\n    });\r\n  } catch (error) {\r\n    console.error('Error updating settings:', error);\r\n    return NextResponse.json(\r\n      { error: 'Failed to update settings' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAGO,eAAe;IACpB,IAAI;QACF,MAAM,WAAW,MAAM,0HAAM,CAAC,YAAY,CAAC,UAAU,CAAC;YACpD,OAAO;gBAAE,KAAK;YAAO;QACvB;QAEA,IAAI,CAAC,UAAU;YACb,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACvB,aAAa;gBACb,gBAAgB;gBAChB,cAAc;gBACd,gBAAgB;YAClB;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,aAAa,SAAS,WAAW,IAAI;YACrC,gBAAgB,SAAS,cAAc,IAAI;YAC3C,cAAc,SAAS,YAAY,IAAI;YACvC,gBAAgB,CAAC,CAAC,SAAS,WAAW;QACxC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA2B,GACpC;YAAE,QAAQ;QAAI;IAElB;AACF;AAGO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,kBAAkB,MAAM,IAAA,gIAAe;QAC7C,IAAI,CAAC,iBAAiB;YACpB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAe,GACxB;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,WAAW,MAAM,QAAQ,QAAQ;QACvC,MAAM,cAAc,SAAS,GAAG,CAAC;QACjC,MAAM,iBAAiB,SAAS,GAAG,CAAC;QACpC,MAAM,eAAe,SAAS,GAAG,CAAC;QAClC,MAAM,cAAc,SAAS,GAAG,CAAC;QACjC,MAAM,eAAe,SAAS,GAAG,CAAC,oBAAoB;QAEtD,MAAM,aAMF;YACF,aAAa,eAAe;YAC5B,gBAAgB,kBAAkB;YAClC,cAAc,gBAAgB;QAChC;QAEA,IAAI,cAAc;YAChB,WAAW,WAAW,GAAG;YACzB,WAAW,cAAc,GAAG;QAC9B,OAAO,IAAI,eAAe,YAAY,IAAI,GAAG,GAAG;YAC9C,MAAM,SAAS,OAAO,IAAI,CAAC,MAAM,YAAY,WAAW;YACxD,WAAW,WAAW,GAAG;YACzB,WAAW,cAAc,GAAG,YAAY,IAAI;QAC9C;QAEA,MAAM,WAAW,MAAM,0HAAM,CAAC,YAAY,CAAC,MAAM,CAAC;YAChD,OAAO;gBAAE,KAAK;YAAO;YACrB,QAAQ;YACR,QAAQ;gBACN,KAAK;gBACL,GAAG,UAAU;YACf;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,aAAa,SAAS,WAAW;YACjC,gBAAgB,SAAS,cAAc;YACvC,cAAc,SAAS,YAAY;YACnC,gBAAgB,CAAC,CAAC,SAAS,WAAW;QACxC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA4B,GACrC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}