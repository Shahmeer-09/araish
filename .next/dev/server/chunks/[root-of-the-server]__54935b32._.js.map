{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/downloads/project/jewelry-showcase/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined;\r\n};\r\n\r\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\r\n\r\nexport default prisma;\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,sMAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///E:/downloads/project/jewelry-showcase/lib/auth.ts"],"sourcesContent":["import { cookies } from 'next/headers';\r\nimport bcrypt from 'bcryptjs';\r\nimport prisma from './prisma';\r\n\r\nconst SESSION_COOKIE_NAME = 'admin_session';\r\nconst SESSION_SECRET = process.env.SESSION_SECRET || 'your-secret-key-change-in-production';\r\n\r\nexport async function hashPassword(password: string): Promise<string> {\r\n  return bcrypt.hash(password, 12);\r\n}\r\n\r\nexport async function verifyPassword(password: string, hashedPassword: string): Promise<boolean> {\r\n  return bcrypt.compare(password, hashedPassword);\r\n}\r\n\r\nexport async function createSession(username: string): Promise<string> {\r\n  const sessionToken = Buffer.from(`${username}:${Date.now()}:${SESSION_SECRET}`).toString('base64');\r\n  return sessionToken;\r\n}\r\n\r\nexport async function validateSession(): Promise<boolean> {\r\n  const cookieStore = await cookies();\r\n  const session = cookieStore.get(SESSION_COOKIE_NAME);\r\n  \r\n  if (!session?.value) {\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    const decoded = Buffer.from(session.value, 'base64').toString('utf-8');\r\n    const [username] = decoded.split(':');\r\n    \r\n    const admin = await prisma.admin.findUnique({\r\n      where: { username },\r\n    });\r\n\r\n    return !!admin;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function login(username: string, password: string): Promise<{ success: boolean; error?: string }> {\r\n  try {\r\n    const admin = await prisma.admin.findUnique({\r\n      where: { username },\r\n    });\r\n\r\n    if (!admin) {\r\n      return { success: false, error: 'Invalid credentials' };\r\n    }\r\n\r\n    const isValid = await verifyPassword(password, admin.password);\r\n\r\n    if (!isValid) {\r\n      return { success: false, error: 'Invalid credentials' };\r\n    }\r\n\r\n    const sessionToken = await createSession(username);\r\n    const cookieStore = await cookies();\r\n    \r\n    cookieStore.set(SESSION_COOKIE_NAME, sessionToken, {\r\n      httpOnly: true,\r\n      secure: process.env.NODE_ENV === 'production',\r\n      sameSite: 'lax',\r\n      maxAge: 60 * 60 * 24, // 24 hours\r\n      path: '/',\r\n    });\r\n\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Login error:', error);\r\n    return { success: false, error: 'An error occurred during login' };\r\n  }\r\n}\r\n\r\nexport async function logout(): Promise<void> {\r\n  const cookieStore = await cookies();\r\n  cookieStore.delete(SESSION_COOKIE_NAME);\r\n}\r\n\r\nexport async function createAdminIfNotExists(): Promise<void> {\r\n  const adminUsername = process.env.ADMIN_USERNAME || 'admin';\r\n  const adminPassword = process.env.ADMIN_PASSWORD || 'admin123';\r\n\r\n  const existingAdmin = await prisma.admin.findUnique({\r\n    where: { username: adminUsername },\r\n  });\r\n\r\n  if (!existingAdmin) {\r\n    const hashedPassword = await hashPassword(adminPassword);\r\n    await prisma.admin.create({\r\n      data: {\r\n        username: adminUsername,\r\n        password: hashedPassword,\r\n      },\r\n    });\r\n    console.log('Admin user created');\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;;;;;;AAEA;;;;AAEA,MAAM,sBAAsB;AAC5B,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc,IAAI;AAE9C,eAAe,aAAa,QAAgB;IACjD,OAAO,OAAO,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAgB,EAAE,cAAsB;IAC3E,OAAO,OAAO,OAAO,CAAC,UAAU;AAClC;AAEO,eAAe,cAAc,QAAgB;IAClD,MAAM,eAAe,OAAO,IAAI,CAAC,GAAG,SAAS,CAAC,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,gBAAgB,EAAE,QAAQ,CAAC;IACzF,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,UAAU,YAAY,GAAG,CAAC;IAEhC,IAAI,CAAC,SAAS,OAAO;QACnB,OAAO;IACT;IAEA,IAAI;QACF,MAAM,UAAU,OAAO,IAAI,CAAC,QAAQ,KAAK,EAAE,UAAU,QAAQ,CAAC;QAC9D,MAAM,CAAC,SAAS,GAAG,QAAQ,KAAK,CAAC;QAEjC,MAAM,QAAQ,MAAM,0HAAM,CAAC,KAAK,CAAC,UAAU,CAAC;YAC1C,OAAO;gBAAE;YAAS;QACpB;QAEA,OAAO,CAAC,CAAC;IACX,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,MAAM,QAAgB,EAAE,QAAgB;IAC5D,IAAI;QACF,MAAM,QAAQ,MAAM,0HAAM,CAAC,KAAK,CAAC,UAAU,CAAC;YAC1C,OAAO;gBAAE;YAAS;QACpB;QAEA,IAAI,CAAC,OAAO;YACV,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAsB;QACxD;QAEA,MAAM,UAAU,MAAM,eAAe,UAAU,MAAM,QAAQ;QAE7D,IAAI,CAAC,SAAS;YACZ,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAsB;QACxD;QAEA,MAAM,eAAe,MAAM,cAAc;QACzC,MAAM,cAAc,MAAM,IAAA,4IAAO;QAEjC,YAAY,GAAG,CAAC,qBAAqB,cAAc;YACjD,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK;YAClB,MAAM;QACR;QAEA,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO;YAAE,SAAS;YAAO,OAAO;QAAiC;IACnE;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;AACrB;AAEO,eAAe;IACpB,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc,IAAI;IACpD,MAAM,gBAAgB,QAAQ,GAAG,CAAC,cAAc,IAAI;IAEpD,MAAM,gBAAgB,MAAM,0HAAM,CAAC,KAAK,CAAC,UAAU,CAAC;QAClD,OAAO;YAAE,UAAU;QAAc;IACnC;IAEA,IAAI,CAAC,eAAe;QAClB,MAAM,iBAAiB,MAAM,aAAa;QAC1C,MAAM,0HAAM,CAAC,KAAK,CAAC,MAAM,CAAC;YACxB,MAAM;gBACJ,UAAU;gBACV,UAAU;YACZ;QACF;QACA,QAAQ,GAAG,CAAC;IACd;AACF"}},
    {"offset": {"line": 186, "column": 0}, "map": {"version":3,"sources":["file:///E:/downloads/project/jewelry-showcase/app/api/auth/check/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { validateSession } from '@/lib/auth';\r\n\r\nexport async function GET() {\r\n  try {\r\n    const isAuthenticated = await validateSession();\r\n    return NextResponse.json({ authenticated: isAuthenticated });\r\n  } catch (error) {\r\n    console.error('Auth check error:', error);\r\n    return NextResponse.json({ authenticated: false });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,kBAAkB,MAAM,IAAA,gIAAe;QAC7C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,eAAe;QAAgB;IAC5D,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,eAAe;QAAM;IAClD;AACF"}}]
}